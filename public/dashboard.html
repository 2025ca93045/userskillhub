<h2>User Dashboard</h2>
<pre id="me"></pre>

<h3>Users</h3>
<ul id="users"></ul>

<h3>Courses</h3>
<ul id="courses"></ul>

<h3>My Sessions</h3>
<ul id="sessions"></ul>

<script>
async function loadSessions() {
  const sessions = await fetch("/student-sessions").then(r => r.json());
  sessions.forEach(s => {
    sessions.innerHTML += `<li>${s.title} [${s.status}]</li>`;
  });
}

loadSessions();
</script>

<script>
async function load() {
  document.getElementById("me").textContent =
    JSON.stringify(await fetch("/me").then(r=>r.json()),null,2);

  (await fetch("/users").then(r=>r.json()))
    .forEach(u => users.innerHTML += `<li>${u.email} (${u.role})</li>`);

  (await fetch("/courses").then(r=>r.json()))
    .forEach(c => courses.innerHTML +=
      `<li>${c.title} - ${c.instructor}
       <button onclick="req(${c.id})">Request</button></li>`);
}

function req(id) {
  fetch("/request", {
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify({ course_id:id })
  });
}

load();
</script>
